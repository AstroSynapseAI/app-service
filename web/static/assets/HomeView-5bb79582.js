import{_ as I,j as S,k as C,r as y,l as B,o as P,a as r,m as T,n as L,b as t,p as D,g as c,f as A,i as E,q as R,s as $,x as F,y as H,z as M,A as N,B as K,M as z,C as b,D as x,c as i,F as U,e as q,E as h,h as O,G as j,H as G,I as V}from"./index-f3458156.js";const W=l=>(H("data-v-57918cce"),l=l(),M(),l),J=["disabled","onClick"],Q=W(()=>t("i",{class:"align-middle","data-feather":"send"},null,-1)),X=[Q],Y={__name:"PromptInput",setup(l){const g=S(),d=C(),a=y("");B();function p(e){e.target.style.height="auto";const n=parseInt(window.getComputedStyle(e.target).getPropertyValue("line-height"));let o=Math.floor(e.target.scrollHeight/n);const s=10;o=o>s?s:o,e.target.style.height=`${o*n}px`}function _(e){e.preventDefault();let n=e.target.selectionStart,o=a.value.substring(0,n),s=a.value.substring(n);a.value=o+`
`+s,F(()=>{p(e)})}function m(e,n){if(e.preventDefault(),a.value.trim()!==""){const o={session_id:g.session_id,avatar_id:g.avatar.ID,msg:a.value};console.log("Prompt:",o),d.sendPrompt(o),e.target.style.height="auto",n()}}function v(e,n){!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?e.shiftKey&&e.key=="Enter"?_(e):e.key=="Enter"&&m(e,n):e.key=="Enter"&&_(e)}return P(()=>{feather.replace()}),(e,n)=>(r(),T(c($),null,{default:L(({resetForm:o})=>[t("div",{class:D([{"textarea-container":!0,loading:c(d).isLoading,"form-control":!0},"form-control"])},[A(c(E),{onInput:p,onKeydown:R(s=>v(s,o),["enter"]),name:"prompt",modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=s=>a.value=s),type:"text",as:"textarea",class:"",rows:"2",placeholder:"Send a message...",disabled:c(d).isLoading},null,8,["onKeydown","modelValue","disabled"]),t("button",{class:"send-button btn btn-light",disabled:c(d).isLoading,onClick:s=>m(s,o)},X,8,J)],2)]),_:1}))}},Z=I(Y,[["__scopeId","data-v-57918cce"]]);const f=l=>(H("data-v-576a1827"),l=l(),M(),l),ee={class:"container-fluid"},te=f(()=>t("h1",{class:"h3 mb-3"},"Avatar",-1)),se={class:"row"},oe={class:"col-12"},ae={class:"card"},ne={class:"card-body"},re={class:"container d-flex flex-column"},ie={class:"col-1"},ce={key:0,src:j,class:"logo",alt:"Avatar Icon",width:"35"},le={key:1,src:G,class:"logo",alt:"User Icon",width:"35",height:"50"},de={class:"col-10"},_e={key:0},ue=f(()=>t("span",{class:"me-3"},"I'm thinking... ",-1)),pe={class:"spinner mb-2 me-2"},he={key:0,src:V,alt:""},me={key:0},ge={class:"me-3 fst-italic"},fe=f(()=>t("span",{class:"spinner mb-2 me-2"},[t("img",{src:V,alt:""})],-1)),ve=["innerHTML"],ye={key:0,class:"separator opacity-100"},ke=f(()=>t("hr",{class:"border border-3 opacity-100"},null,-1)),we={__name:"HomeView",setup(l){const g=N(),d=C(),{messages:a}=K(d),p=S(),_=y(null),m=y(null),v=new z({breaks:!0}),e=b(()=>a.value.length-1),n=b(()=>{var s;return((s=a.value[e.value])==null?void 0:s.content)||""});async function o(){requestAnimationFrame(()=>{if(_.value){var s=m.value.offsetHeight+30,k=_.value.scrollHeight+s;_.value.scrollTop=k}})}return x(a,()=>{o()}),x(n,()=>{o()}),P(async()=>{try{p.session_id||await p.getSessionToken(),await d.getPrivateSession(g.params.avatar_id,p.session_id)}catch(s){console.log(s)}o(),feather.replace(),d.connectWebSocket()}),(s,k)=>(r(),i("div",ee,[te,t("div",se,[t("div",oe,[t("div",ae,[t("div",ne,[t("div",re,[t("div",{ref_key:"conversationContainer",ref:_,class:"conversation-container flex-grow-1 overflow-auto"},[c(a).length>0?(r(!0),i(U,{key:0},q(c(a),(u,w)=>(r(),i("div",{class:"conversation-item row",key:w},[t("div",ie,[u.type==="ai"?(r(),i("img",ce)):h("",!0),u.type==="human"?(r(),i("img",le)):h("",!0)]),t("div",de,[u.isLoading?(r(),i("div",_e,[t("p",null,[ue,t("span",pe,[u.isAgentRunnig?h("",!0):(r(),i("img",he))])]),u.isAgentRunnig?(r(),i("p",me,[t("span",ge,"Activating agent: "+O(u.agentName)+"... ",1),fe])):h("",!0)])):(r(),i("div",{key:1,class:"message-content pe-3",innerHTML:c(v).render(u.content.trim())},null,8,ve))]),c(a).length>1&&w!==c(a).length-1?(r(),i("hr",ye)):h("",!0)]))),128)):h("",!0)],512),t("div",{ref_key:"promptContainer",ref:m,class:"prompt-container"},[ke,A(Z)],512)])])])])])]))}},xe=I(we,[["__scopeId","data-v-576a1827"]]);export{xe as default};
