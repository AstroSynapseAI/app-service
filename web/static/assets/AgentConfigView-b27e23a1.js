import{v as P,t as p,b as m,o as R,d as n,e,M as U,l as b,f as F,g as B,N as w,O as j,j as T,k as I,J as x,K as E,i,F as H,P as J}from"./index-7a4cb04d.js";import{u as K}from"./avatar.store-7fa534a5.js";import{u as O}from"./agent.store-3fa6ba60.js";import{u as $}from"./llm.store-c02b0d93.js";import{u as q}from"./tool.store-f25fda9f.js";const z={class:"container-fluid p-0"},G={class:"h3 mb-3"},Q={class:"form-check form-switch float-end me-5"},W=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Active",-1),X=["checked"],Y={class:"form-check form-switch float-end me-3"},Z=e("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Public",-1),ee=["checked"],te={class:"row"},oe={class:"col-12"},ae={class:"card"},se={class:"card-body"},le={class:"container"},ce={class:"row"},ne={class:"col-12"},ie=e("h3",null,"Primer",-1),re={class:"row mt-3"},de={class:"col-12"},ue=e("h3",null,"Agent Model",-1),ve=e("option",{value:"",disabled:"",selected:""},"Select a LLM",-1),_e=["value"],he={class:"row mt-3"},me={key:0,class:"col-12"},fe=e("h3",null,"Agent Tools",-1),ge={class:"list-group"},pe={key:0,class:"form-floating mb-3"},ke=["onUpdate:modelValue"],be=e("label",{for:"apiToken"},"Api Token",-1),Ae=e("i",{"data-feather":"settings",class:"float-end"},null,-1),De={class:"form-check form-switch float-end me-3"},we=e("label",{class:"form-check-label",for:"checkboxTool{{ tool.ID }}"},"Active",-1),Te=["onClick","checked"],Me={__name:"AgentConfigView",setup(Ie){P();const l=K(),c=E(),d=O(),s=p(d,"record"),r=p(d,"activeTools"),A=$(),y=p(A,"records"),k=q(),f=p(k,"records"),u=m(""),S=m(""),g=m(""),v=m(!1),_=m(!1),C=a=>{const o=r.value.find(t=>t.tool.ID==a);return o?o.is_active:!1},V=()=>{v.value=!v.value},M=()=>{_.value=!_.value},L=a=>{const o=r.value.find(t=>t.tool.ID==a.ID);if(!o){const t={active_agent_id:s.value.ID,tool_id:a.ID,token:a.token,tool:a,is_active:!0};r.value.push(t);return}o.is_active=!o.is_active,o.token=a.token,console.log("activeTools",r.value)},N=async()=>{const a={ID:parseInt(c.params.active_agent_id),avatar_id:parseInt(c.params.avatar_id),agent_id:parseInt(c.params.agent_id),llm_id:g.value,primer:u.value,is_active:v.value,is_public:_.value};s.value.ID&&(a.ID=s.value.ID);try{await d.saveActiveAgent(a);for(const o of r.value)await k.saveAgentTool(o)}catch(o){console.log(o)}};return R(async()=>{try{await A.getLLMs(),await k.getTools(),await d.getAgent(c.params.agent_id),s.value&&(u.value=s.value.primer,S.value=s.value.name),c.params.active_agent_id&&(await l.getActiveAgent(c.params.agent_id,c.params.avatar_id),await d.getActiveTools(l.activeAgent.agent_id),l.activeAgent&&(g.value=l.activeAgent.llm_id,u.value=l.activeAgent.primer,v.value=l.activeAgent.is_active,_.value=l.activeAgent.is_public));for(const[a,o]of f.value.entries()){const t=r.value.find(h=>h.tool.ID==o.ID);t&&(o.token=t.token),f.value[a]=o}console.log("loaded tool records:",f.value)}catch(a){console.log(a)}feather.replace()}),(a,o)=>(i(),n("div",z,[e("h1",G,[U("Configure: "+b(s.value.name)+" ",1),e("div",Q,[W,e("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:v.value,onClick:V},null,8,X)]),e("div",Y,[Z,e("input",{class:"form-check-input",type:"checkbox",id:"flexSwitchCheckDefault",checked:_.value,onClick:M},null,8,ee)])]),e("div",te,[e("div",oe,[e("div",ae,[e("div",se,[e("div",le,[e("div",ce,[e("div",ne,[ie,F(B(H),{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=t=>u.value=t),name:"agent_primer",type:"text",as:"textarea",class:"form-control",rows:"8",placeholder:"How should the agent behave..."},null,8,["modelValue"])])]),e("div",re,[e("div",de,[ue,w(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>g.value=t),class:"form-select model-select","aria-label":"Select Model"},[ve,(i(!0),n(T,null,I(y.value,(t,h)=>(i(),n("option",{value:t.ID,key:h},b(t.name),9,_e))),128))],512),[[j,g.value]])])]),e("div",he,[s.value.slug==="search-agent"?(i(),n("div",me,[fe,e("ul",ge,[(i(!0),n(T,null,I(f.value,(t,h)=>(i(),n("li",{key:h,class:"list-group-item"},[e("span",null,b(t.name),1),t.slug!="ddg-search"?(i(),n("div",pe,[w(e("input",{type:"text",class:"form-control",id:"apiToken",placeholder:"Tool Token","onUpdate:modelValue":D=>t.token=D},null,8,ke),[[J,t.token]]),be])):x("",!0),Ae,e("div",De,[we,e("input",{class:"form-check-input",type:"checkbox",id:"checkboxTool{{ tool.ID }}",onClick:D=>L(t),checked:C(t.ID)},null,8,Te)])]))),128))])])):x("",!0)]),e("div",{class:"row mt-3"},[e("div",{class:"col-12"},[e("button",{type:"button",class:"btn btn-secondary",onClick:N},"Save")])])])])])])])]))}};export{Me as default};
